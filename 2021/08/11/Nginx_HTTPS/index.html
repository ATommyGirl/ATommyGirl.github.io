<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="ä»¥ä¸‹å†…å®¹è½¬è½½è‡ª è¿™é‡Œ ã€‚è½¬è½½çš„åŸå› æ˜¯æ€•ä»–ä»¬çš„ç½‘ç«™çªç„¶è®¿é—®ä¸äº†ğŸ˜‚ã€‚  ç ”ç©¶ HTTPS çš„åŒå‘è®¤è¯å®ç°ä¸åŸç†ï¼Œè¸©äº†ä¸å°‘å‘ï¼Œç»ˆäºæ•´ä¸ªæµç¨‹éƒ½è·‘é€šäº†ï¼Œç°åœ¨æ€»ç»“å‡ºä¸€ç¯‡æ–‡æ¡£æ¥ï¼ŒæŠŠä¸€äº›å¿ƒå¾—ï¼Œç‰¹åˆ«æ˜¯å®¹æ˜“è¸©å‘çš„åœ°æ–¹è®°å½•ä¸‹æ¥ã€‚ 1. åŸç†åŒå‘è®¤è¯ï¼Œé¡¾åæ€ä¹‰ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½éœ€è¦éªŒè¯å¯¹æ–¹çš„èº«ä»½ï¼Œåœ¨å»ºç«‹ HTTPS è¿æ¥çš„è¿‡ç¨‹ä¸­ï¼Œæ¡æ‰‹çš„æµç¨‹æ¯”å•å‘è®¤è¯å¤šäº†å‡ æ­¥ã€‚å•å‘è®¤è¯çš„è¿‡ç¨‹ï¼Œå®¢æˆ·ç«¯ä»æœåŠ¡å™¨ç«¯ä¸‹è½½æœåŠ¡å™¨ç«¯å…¬é’¥è¯ä¹¦è¿›è¡ŒéªŒ">
<meta property="og:type" content="article">
<meta property="og:title" content="ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯">
<meta property="og:url" content="https://tommygirl.cn/2021/08/11/Nginx_HTTPS/index.html">
<meta property="og:site_name" content="ç™½å°å’ª">
<meta property="og:description" content="ä»¥ä¸‹å†…å®¹è½¬è½½è‡ª è¿™é‡Œ ã€‚è½¬è½½çš„åŸå› æ˜¯æ€•ä»–ä»¬çš„ç½‘ç«™çªç„¶è®¿é—®ä¸äº†ğŸ˜‚ã€‚  ç ”ç©¶ HTTPS çš„åŒå‘è®¤è¯å®ç°ä¸åŸç†ï¼Œè¸©äº†ä¸å°‘å‘ï¼Œç»ˆäºæ•´ä¸ªæµç¨‹éƒ½è·‘é€šäº†ï¼Œç°åœ¨æ€»ç»“å‡ºä¸€ç¯‡æ–‡æ¡£æ¥ï¼ŒæŠŠä¸€äº›å¿ƒå¾—ï¼Œç‰¹åˆ«æ˜¯å®¹æ˜“è¸©å‘çš„åœ°æ–¹è®°å½•ä¸‹æ¥ã€‚ 1. åŸç†åŒå‘è®¤è¯ï¼Œé¡¾åæ€ä¹‰ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½éœ€è¦éªŒè¯å¯¹æ–¹çš„èº«ä»½ï¼Œåœ¨å»ºç«‹ HTTPS è¿æ¥çš„è¿‡ç¨‹ä¸­ï¼Œæ¡æ‰‹çš„æµç¨‹æ¯”å•å‘è®¤è¯å¤šäº†å‡ æ­¥ã€‚å•å‘è®¤è¯çš„è¿‡ç¨‹ï¼Œå®¢æˆ·ç«¯ä»æœåŠ¡å™¨ç«¯ä¸‹è½½æœåŠ¡å™¨ç«¯å…¬é’¥è¯ä¹¦è¿›è¡ŒéªŒ">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ata2-img.cn-hangzhou.oss-pub.aliyun-inc.com/14158ca87e2f341ff044efd967f3e008.png">
<meta property="og:image" content="https://ata2-img.cn-hangzhou.oss-pub.aliyun-inc.com/08e6235892053a81603a4c3d7c7f44ad.png">
<meta property="og:image" content="https://www.hi-linux.com/img/linux/nginx-ssl-03.png">
<meta property="article:published_time" content="2021-08-11T05:29:02.000Z">
<meta property="article:modified_time" content="2021-08-11T05:29:02.000Z">
<meta property="article:author" content="YYLittleCat">
<meta property="article:tag" content="è½¬è½½">
<meta property="article:tag" content="ç½‘ç»œ">
<meta property="article:tag" content="Nginx">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ata2-img.cn-hangzhou.oss-pub.aliyun-inc.com/14158ca87e2f341ff044efd967f3e008.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/mini-icon.svg">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.0.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" "Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives">å½’æ¡£</a></li>
         
          <li><a href="/tags">æ ‡ç­¾</a></li>
         
          <li><a href="/about">å…³äº</a></li>
         
          <li><a href="/search/">æœç´¢</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="ä¸Šä¸€ç¯‡ " href="/2021/08/19/Cordova_config.xml/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="ä¸‹ä¸€ç¯‡ " href="/2021/07/23/Systemd_Use/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="è¿”å›é¡¶éƒ¨ " href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="åˆ†äº«æ–‡ç«  " href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">ä¸Šä¸€ç¯‡</span>
      <span id="i-next" class="info" style="display:none;">ä¸‹ä¸€ç¯‡</span>
      <span id="i-top" class="info" style="display:none;">è¿”å›é¡¶éƒ¨</span>
      <span id="i-share" class="info" style="display:none;">åˆ†äº«æ–‡ç« </span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&text=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&title=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&is_video=false&description=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯&body=Check out this article: https://tommygirl.cn/2021/08/11/Nginx_HTTPS/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&title=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&title=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&title=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&title=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&name=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯&description=&lt;p&gt;ä»¥ä¸‹å†…å®¹è½¬è½½è‡ª &lt;a href=&#34;https://www.hi-linux.com/posts/38492.html&#34;&gt;è¿™é‡Œ&lt;/a&gt; ã€‚è½¬è½½çš„åŸå› æ˜¯æ€•ä»–ä»¬çš„ç½‘ç«™çªç„¶è®¿é—®ä¸äº†ğŸ˜‚ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;ç ”ç©¶ HTTPS çš„åŒå‘è®¤è¯å®ç°ä¸åŸç†ï¼Œè¸©äº†ä¸å°‘å‘ï¼Œç»ˆäºæ•´ä¸ªæµç¨‹éƒ½è·‘é€šäº†ï¼Œç°åœ¨æ€»ç»“å‡ºä¸€ç¯‡æ–‡æ¡£æ¥ï¼ŒæŠŠä¸€äº›å¿ƒå¾—ï¼Œç‰¹åˆ«æ˜¯å®¹æ˜“è¸©å‘çš„åœ°æ–¹è®°å½•ä¸‹æ¥ã€‚&lt;/p&gt;
&lt;h2 id=&#34;1-åŸç†&#34;&gt;&lt;a href=&#34;#1-åŸç†&#34; class=&#34;headerlink&#34; title=&#34;1. åŸç†&#34;&gt;&lt;/a&gt;1. åŸç†&lt;/h2&gt;&lt;p&gt;åŒå‘è®¤è¯ï¼Œé¡¾åæ€ä¹‰ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½éœ€è¦éªŒè¯å¯¹æ–¹çš„èº«ä»½ï¼Œåœ¨å»ºç«‹ &lt;code&gt;HTTPS&lt;/code&gt; è¿æ¥çš„è¿‡ç¨‹ä¸­ï¼Œæ¡æ‰‹çš„æµç¨‹æ¯”å•å‘è®¤è¯å¤šäº†å‡ æ­¥ã€‚å•å‘è®¤è¯çš„è¿‡ç¨‹ï¼Œå®¢æˆ·ç«¯ä»æœåŠ¡å™¨ç«¯ä¸‹è½½æœåŠ¡å™¨ç«¯å…¬é’¥è¯ä¹¦è¿›è¡ŒéªŒè¯ï¼Œç„¶åå»ºç«‹å®‰å…¨é€šä¿¡é€šé“ã€‚åŒå‘é€šä¿¡æµç¨‹ï¼Œå®¢æˆ·ç«¯é™¤äº†éœ€è¦ä»æœåŠ¡å™¨ç«¯ä¸‹è½½æœåŠ¡å™¨çš„å…¬é’¥è¯ä¹¦è¿›è¡ŒéªŒè¯å¤–ï¼Œè¿˜éœ€è¦æŠŠå®¢æˆ·ç«¯çš„å…¬é’¥è¯ä¹¦ä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯ç»™æœåŠ¡å™¨ç«¯è¿›è¡ŒéªŒè¯ï¼Œç­‰åŒæ–¹éƒ½è®¤è¯é€šè¿‡äº†ï¼Œæ‰å¼€å§‹å»ºç«‹å®‰å…¨é€šä¿¡é€šé“è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚&lt;/p&gt;
&lt;h3 id=&#34;1-1-å•å‘è®¤è¯æµç¨‹&#34;&gt;&lt;a href=&#34;#1-1-å•å‘è®¤è¯æµç¨‹&#34; class=&#34;headerlink&#34; title=&#34;1.1 å•å‘è®¤è¯æµç¨‹&#34;&gt;&lt;/a&gt;1.1 å•å‘è®¤è¯æµç¨‹&lt;/h3&gt;&lt;p&gt;å•å‘è®¤è¯æµç¨‹ä¸­ï¼ŒæœåŠ¡å™¨ç«¯ä¿å­˜ç€å…¬é’¥è¯ä¹¦å’Œç§é’¥ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ•´ä¸ªæ¡æ‰‹è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&t=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%8E%9F%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">1. åŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%8D%95%E5%90%91%E8%AE%A4%E8%AF%81%E6%B5%81%E7%A8%8B"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 å•å‘è®¤è¯æµç¨‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81%E6%B5%81%E7%A8%8B"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 åŒå‘è®¤è¯æµç¨‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%AF%81%E4%B9%A6%E7%94%9F%E6%88%90"><span class="toc-number">2.</span> <span class="toc-text">2. è¯ä¹¦ç”Ÿæˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E7%94%9F%E6%88%90%E8%87%AA%E7%AD%BE%E5%90%8D%E6%A0%B9%E8%AF%81%E4%B9%A6"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 ç”Ÿæˆè‡ªç­¾åæ ¹è¯ä¹¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E7%94%9F%E6%88%90%E8%87%AA%E7%AD%BE%E5%90%8D%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%81%E4%B9%A6"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 ç”Ÿæˆè‡ªç­¾åæœåŠ¡å™¨ç«¯è¯ä¹¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E7%94%9F%E6%88%90%E8%87%AA%E7%AD%BE%E5%90%8D%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%AF%81%E4%B9%A6"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 ç”Ÿæˆè‡ªç­¾åå®¢æˆ·ç«¯è¯ä¹¦</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Nginx-%E9%85%8D%E7%BD%AE"><span class="toc-number">3.</span> <span class="toc-text">3.Nginx é…ç½®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-curl-%E8%B0%83%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">4.curl è°ƒç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Java-%E8%B0%83%E7%94%A8"><span class="toc-number">5.</span> <span class="toc-text">5.Java è°ƒç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%AD%98%E7%96%91"><span class="toc-number">6.</span> <span class="toc-text">6. å­˜ç–‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%89%A9%E5%B1%95%E9%98%85%E8%AF%BB-%E6%9C%AC%E6%96%87%E6%A0%B8%E5%BF%83"><span class="toc-number">7.</span> <span class="toc-text">7. æ‰©å±•é˜…è¯» (æœ¬æ–‡æ ¸å¿ƒ)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%8F%97%E4%BF%A1%E8%AF%81%E4%B9%A6%E8%BF%9B%E8%A1%8C%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81"><span class="toc-number">7.1.</span> <span class="toc-text">ä½¿ç”¨å—ä¿¡è¯ä¹¦è¿›è¡ŒåŒå‘è®¤è¯</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">YYLittleCat</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2021-08-11T05:29:02.000Z" itemprop="datePublished">2021-08-11</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/Nginx/" rel="tag">Nginx</a>, <a class="tag-link-link" href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag">ç½‘ç»œ</a>, <a class="tag-link-link" href="/tags/%E8%BD%AC%E8%BD%BD/" rel="tag">è½¬è½½</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>ä»¥ä¸‹å†…å®¹è½¬è½½è‡ª <a target="_blank" rel="noopener" href="https://www.hi-linux.com/posts/38492.html">è¿™é‡Œ</a> ã€‚è½¬è½½çš„åŸå› æ˜¯æ€•ä»–ä»¬çš„ç½‘ç«™çªç„¶è®¿é—®ä¸äº†ğŸ˜‚ã€‚</p>
<hr>
<p>ç ”ç©¶ HTTPS çš„åŒå‘è®¤è¯å®ç°ä¸åŸç†ï¼Œè¸©äº†ä¸å°‘å‘ï¼Œç»ˆäºæ•´ä¸ªæµç¨‹éƒ½è·‘é€šäº†ï¼Œç°åœ¨æ€»ç»“å‡ºä¸€ç¯‡æ–‡æ¡£æ¥ï¼ŒæŠŠä¸€äº›å¿ƒå¾—ï¼Œç‰¹åˆ«æ˜¯å®¹æ˜“è¸©å‘çš„åœ°æ–¹è®°å½•ä¸‹æ¥ã€‚</p>
<h2 id="1-åŸç†"><a href="#1-åŸç†" class="headerlink" title="1. åŸç†"></a>1. åŸç†</h2><p>åŒå‘è®¤è¯ï¼Œé¡¾åæ€ä¹‰ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½éœ€è¦éªŒè¯å¯¹æ–¹çš„èº«ä»½ï¼Œåœ¨å»ºç«‹ <code>HTTPS</code> è¿æ¥çš„è¿‡ç¨‹ä¸­ï¼Œæ¡æ‰‹çš„æµç¨‹æ¯”å•å‘è®¤è¯å¤šäº†å‡ æ­¥ã€‚å•å‘è®¤è¯çš„è¿‡ç¨‹ï¼Œå®¢æˆ·ç«¯ä»æœåŠ¡å™¨ç«¯ä¸‹è½½æœåŠ¡å™¨ç«¯å…¬é’¥è¯ä¹¦è¿›è¡ŒéªŒè¯ï¼Œç„¶åå»ºç«‹å®‰å…¨é€šä¿¡é€šé“ã€‚åŒå‘é€šä¿¡æµç¨‹ï¼Œå®¢æˆ·ç«¯é™¤äº†éœ€è¦ä»æœåŠ¡å™¨ç«¯ä¸‹è½½æœåŠ¡å™¨çš„å…¬é’¥è¯ä¹¦è¿›è¡ŒéªŒè¯å¤–ï¼Œè¿˜éœ€è¦æŠŠå®¢æˆ·ç«¯çš„å…¬é’¥è¯ä¹¦ä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯ç»™æœåŠ¡å™¨ç«¯è¿›è¡ŒéªŒè¯ï¼Œç­‰åŒæ–¹éƒ½è®¤è¯é€šè¿‡äº†ï¼Œæ‰å¼€å§‹å»ºç«‹å®‰å…¨é€šä¿¡é€šé“è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚</p>
<h3 id="1-1-å•å‘è®¤è¯æµç¨‹"><a href="#1-1-å•å‘è®¤è¯æµç¨‹" class="headerlink" title="1.1 å•å‘è®¤è¯æµç¨‹"></a>1.1 å•å‘è®¤è¯æµç¨‹</h3><p>å•å‘è®¤è¯æµç¨‹ä¸­ï¼ŒæœåŠ¡å™¨ç«¯ä¿å­˜ç€å…¬é’¥è¯ä¹¦å’Œç§é’¥ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ•´ä¸ªæ¡æ‰‹è¿‡ç¨‹å¦‚ä¸‹ï¼š</p>
<span id="more"></span>

<p><img src="https://ata2-img.cn-hangzhou.oss-pub.aliyun-inc.com/14158ca87e2f341ff044efd967f3e008.png" alt="img"></p>
<ol>
<li>å®¢æˆ·ç«¯å‘èµ·å»ºç«‹ HTTPS è¿æ¥è¯·æ±‚ï¼Œå°† SSL åè®®ç‰ˆæœ¬çš„ä¿¡æ¯å‘é€ç»™æœåŠ¡å™¨ç«¯ï¼›</li>
<li>æœåŠ¡å™¨ç«¯å°†æœ¬æœºçš„å…¬é’¥è¯ä¹¦ï¼ˆserver.crtï¼‰å‘é€ç»™å®¢æˆ·ç«¯ï¼›</li>
<li>å®¢æˆ·ç«¯è¯»å–å…¬é’¥è¯ä¹¦ (server.crt)ï¼Œå–å‡ºäº†æœåŠ¡ç«¯å…¬é’¥ï¼›</li>
<li>å®¢æˆ·ç«¯ç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼ˆå¯†é’¥ Rï¼‰ï¼Œç”¨åˆšæ‰å¾—åˆ°çš„æœåŠ¡å™¨å…¬é’¥å»åŠ å¯†è¿™ä¸ªéšæœºæ•°å½¢æˆå¯†æ–‡ï¼Œå‘é€ç»™æœåŠ¡ç«¯ï¼›</li>
<li>æœåŠ¡ç«¯ç”¨è‡ªå·±çš„ç§é’¥ (server.key) å»è§£å¯†è¿™ä¸ªå¯†æ–‡ï¼Œå¾—åˆ°äº†å¯†é’¥ R</li>
<li>æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯åœ¨åç»­é€šè®¯è¿‡ç¨‹ä¸­å°±ä½¿ç”¨è¿™ä¸ªå¯†é’¥ R è¿›è¡Œé€šä¿¡äº†ã€‚</li>
</ol>
<h3 id="1-2-åŒå‘è®¤è¯æµç¨‹"><a href="#1-2-åŒå‘è®¤è¯æµç¨‹" class="headerlink" title="1.2 åŒå‘è®¤è¯æµç¨‹"></a>1.2 åŒå‘è®¤è¯æµç¨‹</h3><p><img src="https://ata2-img.cn-hangzhou.oss-pub.aliyun-inc.com/08e6235892053a81603a4c3d7c7f44ad.png" alt="img"></p>
<ol>
<li>å®¢æˆ·ç«¯å‘èµ·å»ºç«‹ HTTPS è¿æ¥è¯·æ±‚ï¼Œå°† SSL åè®®ç‰ˆæœ¬çš„ä¿¡æ¯å‘é€ç»™æœåŠ¡ç«¯ï¼›</li>
<li>æœåŠ¡å™¨ç«¯å°†æœ¬æœºçš„å…¬é’¥è¯ä¹¦ (server.crt) å‘é€ç»™å®¢æˆ·ç«¯ï¼›</li>
<li>å®¢æˆ·ç«¯è¯»å–å…¬é’¥è¯ä¹¦ (server.crt)ï¼Œå–å‡ºäº†æœåŠ¡ç«¯å…¬é’¥ï¼›</li>
<li>å®¢æˆ·ç«¯å°†å®¢æˆ·ç«¯å…¬é’¥è¯ä¹¦ (client.crt) å‘é€ç»™æœåŠ¡å™¨ç«¯ï¼›</li>
<li>æœåŠ¡å™¨ç«¯è§£å¯†å®¢æˆ·ç«¯å…¬é’¥è¯ä¹¦ï¼Œæ‹¿åˆ°å®¢æˆ·ç«¯å…¬é’¥ï¼›</li>
<li>å®¢æˆ·ç«¯å‘é€è‡ªå·±æ”¯æŒçš„åŠ å¯†æ–¹æ¡ˆç»™æœåŠ¡å™¨ç«¯ï¼›</li>
<li>æœåŠ¡å™¨ç«¯æ ¹æ®è‡ªå·±å’Œå®¢æˆ·ç«¯çš„èƒ½åŠ›ï¼Œé€‰æ‹©ä¸€ä¸ªåŒæ–¹éƒ½èƒ½æ¥å—çš„åŠ å¯†æ–¹æ¡ˆï¼Œä½¿ç”¨å®¢æˆ·ç«¯çš„å…¬é’¥åŠ å¯†åå‘é€ç»™å®¢æˆ·ç«¯ï¼›</li>
<li>å®¢æˆ·ç«¯ä½¿ç”¨è‡ªå·±çš„ç§é’¥è§£å¯†åŠ å¯†æ–¹æ¡ˆï¼Œç”Ÿæˆä¸€ä¸ªéšæœºæ•° Rï¼Œä½¿ç”¨æœåŠ¡å™¨å…¬é’¥åŠ å¯†åä¼ ç»™æœåŠ¡å™¨ç«¯ï¼›</li>
<li>æœåŠ¡ç«¯ç”¨è‡ªå·±çš„ç§é’¥å»è§£å¯†è¿™ä¸ªå¯†æ–‡ï¼Œå¾—åˆ°äº†å¯†é’¥ R</li>
<li>æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯åœ¨åç»­é€šè®¯è¿‡ç¨‹ä¸­å°±ä½¿ç”¨è¿™ä¸ªå¯†é’¥ R è¿›è¡Œé€šä¿¡äº†ã€‚</li>
</ol>
<h2 id="2-è¯ä¹¦ç”Ÿæˆ"><a href="#2-è¯ä¹¦ç”Ÿæˆ" class="headerlink" title="2. è¯ä¹¦ç”Ÿæˆ"></a>2. è¯ä¹¦ç”Ÿæˆ</h2><p>ä»ä¸Šä¸€ç« å†…å®¹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºæ¥ï¼Œå¦‚æœè¦æŠŠæ•´ä¸ªåŒå‘è®¤è¯çš„æµç¨‹è·‘é€šï¼Œæœ€ç»ˆéœ€è¦äº”ä¸ªè¯ä¹¦æ–‡ä»¶ï¼š</p>
<ul>
<li>æœåŠ¡å™¨ç«¯å…¬é’¥è¯ä¹¦ï¼šserver.crt</li>
<li>æœåŠ¡å™¨ç«¯ç§é’¥æ–‡ä»¶ï¼šserver.key</li>
<li>å®¢æˆ·ç«¯å…¬é’¥è¯ä¹¦ï¼šclient.crt</li>
<li>å®¢æˆ·ç«¯ç§é’¥æ–‡ä»¶ï¼šclient.key</li>
<li>å®¢æˆ·ç«¯é›†æˆè¯ä¹¦ï¼ˆåŒ…æ‹¬å…¬é’¥å’Œç§é’¥ï¼Œç”¨äºæµè§ˆå™¨è®¿é—®åœºæ™¯ï¼‰ï¼šclient.p12</li>
</ul>
<p>ç”Ÿæˆè¿™ä¸€äº›åˆ—è¯ä¹¦ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆç”Ÿæˆä¸€ä¸ª <code>CA</code> æ ¹è¯ä¹¦ï¼Œç„¶åç”±è¿™ä¸ª <code>CA</code> æ ¹è¯ä¹¦é¢å‘æœåŠ¡å™¨å…¬é’¥è¯ä¹¦å’Œå®¢æˆ·ç«¯å…¬é’¥è¯ä¹¦ã€‚</p>
<p><img src="https://www.hi-linux.com/img/linux/nginx-ssl-03.png" alt="img"></p>
<p>æˆ‘ä»¬å¯ä»¥å…¨ç¨‹ä½¿ç”¨ <code>Openssl</code> æ¥ç”Ÿæˆä¸€äº›åˆ—çš„è‡ªç­¾åè¯ä¹¦ï¼Œè‡ªç­¾åè¯ä¹¦æ²¡æœ‰é€šè¿‡è¯ä¹¦æœºæ„çš„è®¤è¯ï¼Œå¾ˆå¤šæµè§ˆå™¨ä¼šè®¤ä¸ºä¸å®‰å…¨ï¼Œä½†æˆ‘ä»¬ç”¨æ¥å®éªŒæ˜¯è¶³å¤Ÿçš„ã€‚éœ€è¦åœ¨æœ¬æœºå®‰è£…äº† <code>Openssl</code> åæ‰èƒ½ç»§ç»­æœ¬ç« çš„å®éªŒã€‚</p>
<h3 id="2-1-ç”Ÿæˆè‡ªç­¾åæ ¹è¯ä¹¦"><a href="#2-1-ç”Ÿæˆè‡ªç­¾åæ ¹è¯ä¹¦" class="headerlink" title="2.1 ç”Ÿæˆè‡ªç­¾åæ ¹è¯ä¹¦"></a>2.1 ç”Ÿæˆè‡ªç­¾åæ ¹è¯ä¹¦</h3><ol>
<li>åˆ›å»ºæ ¹è¯ä¹¦ç§é’¥ï¼š</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> openssl genrsa -out root.key 1024</span></span><br></pre></td></tr></table></figure>

<ol>
<li>åˆ›å»ºæ ¹è¯ä¹¦è¯·æ±‚æ–‡ä»¶ï¼š</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> openssl req -new -out root.csr -key root.key</span></span><br><span class="line"></span><br><span class="line">åç»­å‚æ•°è¯·è‡ªè¡Œå¡«å†™ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</span><br><span class="line"></span><br><span class="line">Country Name (2 letter code) [XX]:cn</span><br><span class="line">State or Province Name (full name) []:bj</span><br><span class="line">Locality Name (eg, city) [Default City]:bj</span><br><span class="line">Organization Name (eg, company) [Default Company Ltd]:alibaba</span><br><span class="line">Organizational Unit Name (eg, section) []:test</span><br><span class="line">Common Name (eg, your name or your servers hostname) []:www.yourdomain.com</span><br><span class="line">Email Address []:a.alibaba.com</span><br><span class="line">A challenge password []:</span><br><span class="line">An optional company name []:</span><br></pre></td></tr></table></figure>

<ol>
<li>åˆ›å»ºæ ¹è¯ä¹¦ï¼š</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> openssl x509 -req -<span class="keyword">in</span> root.csr -out root.crt -signkey root.key -CAcreateserial -days 3650</span></span><br></pre></td></tr></table></figure>

<p>åœ¨åˆ›å»ºè¯ä¹¦è¯·æ±‚æ–‡ä»¶çš„æ—¶å€™éœ€è¦æ³¨æ„ä¸‰ç‚¹ï¼Œä¸‹é¢ç”ŸæˆæœåŠ¡å™¨è¯·æ±‚æ–‡ä»¶å’Œå®¢æˆ·ç«¯è¯·æ±‚æ–‡ä»¶å‡è¦æ³¨æ„è¿™ä¸‰ç‚¹ï¼š</p>
<ul>
<li>Common Name å¡«å†™è¯ä¹¦å¯¹åº”çš„æœåŠ¡åŸŸåï¼›</li>
<li>æ‰€æœ‰å­—æ®µçš„å¡«å†™ï¼Œæ ¹è¯ä¹¦ã€æœåŠ¡å™¨ç«¯è¯ä¹¦ã€å®¢æˆ·ç«¯è¯ä¹¦éœ€ä¿æŒä¸€è‡´</li>
<li>æœ€åçš„å¯†ç å¯ä»¥ç›´æ¥å›è½¦è·³è¿‡ã€‚</li>
</ul>
<p>ç»è¿‡ä¸Šé¢ä¸‰ä¸ªå‘½ä»¤è¡Œï¼Œæˆ‘ä»¬æœ€ç»ˆå¯ä»¥å¾—åˆ°ä¸€ä¸ªç­¾åæœ‰æ•ˆæœŸä¸º 10 å¹´çš„æ ¹è¯ä¹¦ root.crtï¼Œåé¢æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªæ ¹è¯ä¹¦å»é¢å‘æœåŠ¡å™¨è¯ä¹¦å’Œå®¢æˆ·ç«¯è¯ä¹¦ã€‚</p>
<h3 id="2-2-ç”Ÿæˆè‡ªç­¾åæœåŠ¡å™¨ç«¯è¯ä¹¦"><a href="#2-2-ç”Ÿæˆè‡ªç­¾åæœåŠ¡å™¨ç«¯è¯ä¹¦" class="headerlink" title="2.2 ç”Ÿæˆè‡ªç­¾åæœåŠ¡å™¨ç«¯è¯ä¹¦"></a>2.2 ç”Ÿæˆè‡ªç­¾åæœåŠ¡å™¨ç«¯è¯ä¹¦</h3><ol>
<li>ç”ŸæˆæœåŠ¡å™¨ç«¯è¯ä¹¦ç§é’¥ï¼š</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> openssl genrsa -out server.key 1024</span></span><br></pre></td></tr></table></figure>

<ol>
<li>ç”ŸæˆæœåŠ¡å™¨è¯ä¹¦è¯·æ±‚æ–‡ä»¶ï¼Œè¿‡ç¨‹å’Œæ³¨æ„äº‹é¡¹å‚è€ƒæ ¹è¯ä¹¦ï¼Œæœ¬èŠ‚ä¸è¯¦è¿°ï¼š</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> openssl req -new -out server.csr -key server.key</span></span><br></pre></td></tr></table></figure>

<ol>
<li>ç”ŸæˆæœåŠ¡å™¨ç«¯å…¬é’¥è¯ä¹¦</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> openssl x509 -req -<span class="keyword">in</span> server.csr -out server.crt -signkey server.key -CA root.crt -CAkey root.key -CAcreateserial -days 3650</span></span><br></pre></td></tr></table></figure>

<p>ç»è¿‡ä¸Šé¢çš„ä¸‰ä¸ªå‘½ä»¤ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</p>
<ul>
<li>server.keyï¼šæœåŠ¡å™¨ç«¯çš„ç§˜é’¥æ–‡ä»¶</li>
<li>server.crtï¼šæœ‰æ•ˆæœŸåå¹´çš„æœåŠ¡å™¨ç«¯å…¬é’¥è¯ä¹¦ï¼Œä½¿ç”¨æ ¹è¯ä¹¦å’ŒæœåŠ¡å™¨ç«¯ç§é’¥æ–‡ä»¶ä¸€èµ·ç”Ÿæˆ</li>
</ul>
<h3 id="2-3-ç”Ÿæˆè‡ªç­¾åå®¢æˆ·ç«¯è¯ä¹¦"><a href="#2-3-ç”Ÿæˆè‡ªç­¾åå®¢æˆ·ç«¯è¯ä¹¦" class="headerlink" title="2.3 ç”Ÿæˆè‡ªç­¾åå®¢æˆ·ç«¯è¯ä¹¦"></a>2.3 ç”Ÿæˆè‡ªç­¾åå®¢æˆ·ç«¯è¯ä¹¦</h3><ol>
<li>ç”Ÿæˆå®¢æˆ·ç«¯è¯ä¹¦ç§˜é’¥ï¼š</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> openssl genrsa -out client.key 1024</span></span><br></pre></td></tr></table></figure>

<ol>
<li>ç”Ÿæˆå®¢æˆ·ç«¯è¯ä¹¦è¯·æ±‚æ–‡ä»¶ï¼Œè¿‡ç¨‹å’Œæ³¨æ„äº‹é¡¹å‚è€ƒæ ¹è¯ä¹¦ï¼Œæœ¬èŠ‚ä¸è¯¦è¿°ï¼š</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> openssl req -new -out client.csr -key client.key</span></span><br></pre></td></tr></table></figure>

<ol>
<li>ç”Ÿå®¢æˆ·ç«¯è¯ä¹¦</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> openssl x509 -req -<span class="keyword">in</span> client.csr -out client.crt -signkey client.key -CA root.crt -CAkey root.key -CAcreateserial -days 3650</span></span><br></pre></td></tr></table></figure>

<ol>
<li>ç”Ÿå®¢æˆ·ç«¯ P12 æ ¼å¼è¯ä¹¦</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> openssl pkcs12 -<span class="built_in">export</span> -clcerts -<span class="keyword">in</span> client.crt -inkey client.key -out client.p12</span></span><br></pre></td></tr></table></figure>

<p>ç»è¿‡ä¸Šé¢çš„ä¸‰ä¸ªå‘½ä»¤ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</p>
<ul>
<li>client.keyï¼šå®¢æˆ·ç«¯çš„ç§é’¥æ–‡ä»¶</li>
<li>client.crtï¼šæœ‰æ•ˆæœŸåå¹´çš„å®¢æˆ·ç«¯è¯ä¹¦ï¼Œä½¿ç”¨æ ¹è¯ä¹¦å’Œå®¢æˆ·ç«¯ç§é’¥ä¸€èµ·ç”Ÿæˆ</li>
<li>client.p12ï¼šå®¢æˆ·ç«¯ p12 æ ¼å¼ï¼Œè¿™ä¸ªè¯ä¹¦æ–‡ä»¶åŒ…å«å®¢æˆ·ç«¯çš„å…¬é’¥å’Œç§é’¥ï¼Œä¸»è¦ç”¨æ¥ç»™æµè§ˆå™¨è®¿é—®ä½¿ç”¨</li>
</ul>
<h2 id="3-Nginx-é…ç½®"><a href="#3-Nginx-é…ç½®" class="headerlink" title="3.Nginx é…ç½®"></a>3.Nginx é…ç½®</h2><p>æœ‰äº†ä¸Šé¢çš„ä¸€äº›åˆ—è¯ä¹¦ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>Nginx</code> æœåŠ¡å™¨ä¸Šé…ç½®åŒå‘è®¤è¯çš„ <code>HTTPS</code> æœåŠ¡äº†ï¼Œå…·ä½“é…ç½®æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">443</span> ssl;</span><br><span class="line">    <span class="attribute">server_name</span>  www.yourdomain.com;</span><br><span class="line">    <span class="attribute">ssl</span>                  <span class="literal">on</span>;  </span><br><span class="line">    <span class="attribute">ssl_certificate</span>      /data/sslKey/server.crt;  <span class="comment">#serverå…¬é’¥è¯ä¹¦</span></span><br><span class="line">    <span class="attribute">ssl_certificate_key</span>  /data/sslKey/server.key;  <span class="comment">#serverç§é’¥</span></span><br><span class="line">    <span class="attribute">ssl_client_certificate</span> /data/sslKey/client.crt;  <span class="comment">#å®¢æˆ·ç«¯å…¬é’¥è¯ä¹¦</span></span><br><span class="line">    <span class="attribute">ssl_verify_client</span> <span class="literal">on</span>;  <span class="comment">#å¼€å¯å®¢æˆ·ç«¯è¯ä¹¦éªŒè¯  </span></span><br><span class="line"></span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="attribute">root</span>   html;</span><br><span class="line">        <span class="attribute">index</span>  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…·ä½“å°±æ˜¯å°†æœåŠ¡å™¨ç«¯çš„ä¸¤ä¸ªè¯ä¹¦æ–‡ä»¶ (server.crt/server.key) å’Œå®¢æˆ·ç«¯çš„å…¬é’¥è¯ä¹¦æ–‡ä»¶ (client.crt) çš„è·¯å¾„é…ç½®åˆ° <code>Nginx</code> çš„ <code>server</code> èŠ‚ç‚¹é…ç½®ä¸­ï¼Œå¹¶ä¸”æŠŠ <code>ssl_verify_client</code> è¿™ä¸ªå‚æ•°è®¾ç½®ä¸º <code>on</code>ã€‚<br>æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„å°±æ˜¯ï¼Œå¦‚æœå®¢æˆ·ç«¯è¯ä¹¦ä¸æ˜¯ç”±æ ¹è¯ä¹¦ç›´æ¥é¢å‘çš„ï¼Œé…ç½®ä¸­è¿˜éœ€è¦åŠ ä¸€ä¸ªé…ç½®ï¼š<code>ssl_verify_depth 1</code> ï¼›é…ç½®å®Œæˆåï¼Œæ‰§è¡Œ <code>nginx -s reload</code> é‡æ–°åŠ è½½ä¸‹å°±ç”Ÿæ•ˆäº†ã€‚</p>
<h2 id="4-curl-è°ƒç”¨"><a href="#4-curl-è°ƒç”¨" class="headerlink" title="4.curl è°ƒç”¨"></a>4.curl è°ƒç”¨</h2><p>ä½¿ç”¨ <code>curl</code> åŠ ä¸Šè¯ä¹¦è·¯å¾„ï¼Œå¯ä»¥ç›´æ¥æµ‹è¯• <code>Nginx</code> çš„ <code>HTTPS</code> åŒå‘è®¤è¯æ˜¯å¦é…ç½®æˆåŠŸã€‚</p>
<ol>
<li>å¸¦è¯ä¹¦çš„æˆåŠŸè°ƒç”¨</li>
</ol>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># --certæŒ‡å®šå®¢æˆ·ç«¯å…¬é’¥è¯ä¹¦çš„è·¯å¾„</span></span><br><span class="line"><span class="comment"># --keyæŒ‡å®šå®¢æˆ·ç«¯ç§é’¥æ–‡ä»¶çš„è·¯å¾„</span></span><br><span class="line"><span class="comment"># -kä¸æ ¡éªŒè¯ä¹¦çš„åˆæ³•æ€§ï¼Œå› ä¸ºæˆ‘ä»¬ç”¨çš„æ˜¯è‡ªç­¾åè¯ä¹¦ï¼Œæ‰€ä»¥éœ€è¦åŠ è¿™ä¸ªå‚æ•°</span></span><br><span class="line"><span class="comment"># å¯ä»¥ä½¿ç”¨ -v æ¥è§‚å¯Ÿå…·ä½“çš„ SSL æ¡æ‰‹è¿‡ç¨‹</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$</span> <span class="built_in">curl</span> -<span class="literal">-cert</span> ./client.crt -<span class="literal">-key</span> ./client.key https://integration<span class="literal">-fred2</span>.fredhuang.com <span class="literal">-k</span> <span class="literal">-v</span></span><br><span class="line">* Rebuilt URL to: https://integration<span class="literal">-fred2</span>.fredhuang.com/</span><br><span class="line">*   Trying <span class="number">47.91</span>.<span class="number">39.145</span>...</span><br><span class="line">* TCP_NODELAY <span class="built_in">set</span></span><br><span class="line">* Connected to integration<span class="literal">-fred2</span>.fredhuang.com (<span class="number">47.91</span>.<span class="number">39.145</span>) port <span class="number">443</span> (<span class="comment">#0)</span></span><br><span class="line">* ALPN, offering h2</span><br><span class="line">* ALPN, offering http/<span class="number">1.1</span></span><br><span class="line">* Cipher selection: ALL:!EXPORT:!EXPORT40:!EXPORT56:!aNULL:!LOW:!RC4:@STRENGTH</span><br><span class="line">* successfully <span class="built_in">set</span> certificate verify locations:</span><br><span class="line">*   CAfile: /etc/ssl/cert.pem</span><br><span class="line">  CApath: none</span><br><span class="line">* TLSv1.<span class="number">2</span> (OUT), TLS handshake, Client hello (<span class="number">1</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (<span class="keyword">IN</span>), TLS handshake, Server hello (<span class="number">2</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (<span class="keyword">IN</span>), TLS handshake, Certificate (<span class="number">11</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (<span class="keyword">IN</span>), TLS handshake, Server key exchange (<span class="number">12</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (<span class="keyword">IN</span>), TLS handshake, Request CERT (<span class="number">13</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (<span class="keyword">IN</span>), TLS handshake, Server finished (<span class="number">14</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (OUT), TLS handshake, Certificate (<span class="number">11</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (OUT), TLS handshake, Client key exchange (<span class="number">16</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (OUT), TLS handshake, CERT verify (<span class="number">15</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (OUT), TLS change cipher, Client hello (<span class="number">1</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (OUT), TLS handshake, Finished (<span class="number">20</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (<span class="keyword">IN</span>), TLS change cipher, Client hello (<span class="number">1</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (<span class="keyword">IN</span>), TLS handshake, Finished (<span class="number">20</span>):</span><br><span class="line">* SSL connection <span class="keyword">using</span> TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256</span><br><span class="line">* ALPN, server accepted to use h2</span><br><span class="line">* Server certificate:</span><br><span class="line">*  subject: C=CN; ST=BeiJing; L=BeiJing; O=Alibaba; OU=Test; CN=integration<span class="literal">-fred2</span>.fredhuang.com; emailAddress=a@alibaba.com</span><br><span class="line">*  <span class="built_in">start</span> date: Oct <span class="number">30</span> <span class="number">06</span>:<span class="number">43</span>:<span class="number">19</span> <span class="number">2019</span> GMT</span><br><span class="line">*  expire date: Oct <span class="number">27</span> <span class="number">06</span>:<span class="number">43</span>:<span class="number">19</span> <span class="number">2029</span> GMT</span><br><span class="line">*  issuer: C=CN; ST=BeiJing; L=BeiJing; O=Alibaba; OU=Test; CN=integration<span class="literal">-fred2</span>.fredhuang.com; emailAddress=a@alibaba.com</span><br><span class="line">*  SSL certificate verify result: self signed certificate (<span class="number">18</span>), continuing anyway.</span><br><span class="line">* <span class="keyword">Using</span> HTTP2, server supports multi-use</span><br><span class="line">* Connection state changed (HTTP/<span class="number">2</span> confirmed)</span><br><span class="line">* Copying HTTP/<span class="number">2</span> <span class="keyword">data</span> <span class="keyword">in</span> stream buffer to connection buffer after upgrade: len=<span class="number">0</span></span><br><span class="line">* <span class="keyword">Using</span> Stream ID: 1 (easy handle 0x7f8ae1809a00)</span><br><span class="line">&gt; GET / HTTP/<span class="number">2</span></span><br><span class="line">&gt; Host: integration<span class="literal">-fred2</span>.fredhuang.com</span><br><span class="line">&gt; User<span class="literal">-Agent</span>: <span class="built_in">curl</span>/<span class="number">7.54</span>.<span class="number">0</span></span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt;</span><br><span class="line">* Connection state changed (MAX_CONCURRENT_STREAMS updated)!</span><br><span class="line">&lt; HTTP/<span class="number">2</span> <span class="number">200</span></span><br><span class="line">&lt; server: Tengine</span><br><span class="line">&lt; date: Fri, <span class="number">01</span> Nov <span class="number">2019</span> <span class="number">11</span>:<span class="number">16</span>:<span class="number">39</span> GMT</span><br><span class="line">&lt; content<span class="literal">-type</span>: text/plain;charset=UTF<span class="literal">-8</span></span><br><span class="line">&lt; content<span class="literal">-length</span>: <span class="number">0</span></span><br></pre></td></tr></table></figure>

<ol>
<li>ä¸å¸¦è¯ä¹¦çš„å¤±è´¥è°ƒç”¨</li>
</ol>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$</span> <span class="built_in">curl</span>  https://integration<span class="literal">-fred2</span>.fredhuang.com <span class="literal">-k</span> <span class="literal">-v</span></span><br><span class="line">* Rebuilt URL to: https://integration<span class="literal">-fred2</span>.fredhuang.com/</span><br><span class="line">*   Trying <span class="number">47.91</span>.<span class="number">39.145</span>...</span><br><span class="line">* TCP_NODELAY <span class="built_in">set</span></span><br><span class="line">* Connected to integration<span class="literal">-fred2</span>.fredhuang.com (<span class="number">47.91</span>.<span class="number">39.145</span>) port <span class="number">443</span> (<span class="comment">#0)</span></span><br><span class="line">* ALPN, offering h2</span><br><span class="line">* ALPN, offering http/<span class="number">1.1</span></span><br><span class="line">* Cipher selection: ALL:!EXPORT:!EXPORT40:!EXPORT56:!aNULL:!LOW:!RC4:@STRENGTH</span><br><span class="line">* successfully <span class="built_in">set</span> certificate verify locations:</span><br><span class="line">*   CAfile: /etc/ssl/cert.pem</span><br><span class="line">  CApath: none</span><br><span class="line">* TLSv1.<span class="number">2</span> (OUT), TLS handshake, Client hello (<span class="number">1</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (<span class="keyword">IN</span>), TLS handshake, Server hello (<span class="number">2</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (<span class="keyword">IN</span>), TLS handshake, Certificate (<span class="number">11</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (<span class="keyword">IN</span>), TLS handshake, Server key exchange (<span class="number">12</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (<span class="keyword">IN</span>), TLS handshake, Request CERT (<span class="number">13</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (<span class="keyword">IN</span>), TLS handshake, Server finished (<span class="number">14</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (OUT), TLS handshake, Certificate (<span class="number">11</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (OUT), TLS handshake, Client key exchange (<span class="number">16</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (OUT), TLS change cipher, Client hello (<span class="number">1</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (OUT), TLS handshake, Finished (<span class="number">20</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (<span class="keyword">IN</span>), TLS change cipher, Client hello (<span class="number">1</span>):</span><br><span class="line">* TLSv1.<span class="number">2</span> (<span class="keyword">IN</span>), TLS handshake, Finished (<span class="number">20</span>):</span><br><span class="line">* SSL connection <span class="keyword">using</span> TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256</span><br><span class="line">* ALPN, server accepted to use h2</span><br><span class="line">* Server certificate:</span><br><span class="line">*  subject: C=CN; ST=BeiJing; L=BeiJing; O=Alibaba; OU=Test; CN=integration<span class="literal">-fred2</span>.fredhuang.com; emailAddress=a@alibaba.com</span><br><span class="line">*  <span class="built_in">start</span> date: Oct <span class="number">30</span> <span class="number">06</span>:<span class="number">43</span>:<span class="number">19</span> <span class="number">2019</span> GMT</span><br><span class="line">*  expire date: Oct <span class="number">27</span> <span class="number">06</span>:<span class="number">43</span>:<span class="number">19</span> <span class="number">2029</span> GMT</span><br><span class="line">*  issuer: C=CN; ST=BeiJing; L=BeiJing; O=Alibaba; OU=Test; CN=integration<span class="literal">-fred2</span>.fredhuang.com; emailAddress=a@alibaba.com</span><br><span class="line">*  SSL certificate verify result: self signed certificate (<span class="number">18</span>), continuing anyway.</span><br><span class="line">* <span class="keyword">Using</span> HTTP2, server supports multi-use</span><br><span class="line">* Connection state changed (HTTP/<span class="number">2</span> confirmed)</span><br><span class="line">* Copying HTTP/<span class="number">2</span> <span class="keyword">data</span> <span class="keyword">in</span> stream buffer to connection buffer after upgrade: len=<span class="number">0</span></span><br><span class="line">* <span class="keyword">Using</span> Stream ID: 1 (easy handle 0x7fcc52805e00)</span><br><span class="line">&gt; GET / HTTP/<span class="number">2</span></span><br><span class="line">&gt; Host: integration<span class="literal">-fred2</span>.fredhuang.com</span><br><span class="line">&gt; User<span class="literal">-Agent</span>: <span class="built_in">curl</span>/<span class="number">7.54</span>.<span class="number">0</span></span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt;</span><br><span class="line">* Connection state changed (MAX_CONCURRENT_STREAMS updated)!</span><br><span class="line">&lt; HTTP/<span class="number">2</span> <span class="number">400</span></span><br><span class="line">&lt; server: Tengine</span><br><span class="line">&lt; date: Fri, <span class="number">01</span> Nov <span class="number">2019</span> <span class="number">11</span>:<span class="number">25</span>:<span class="number">28</span> GMT</span><br><span class="line">&lt; content<span class="literal">-type</span>: text/html</span><br><span class="line">&lt; content<span class="literal">-length</span>: <span class="number">685</span></span><br><span class="line">&lt;</span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC <span class="string">&quot;-//IETF//DTD HTML 2.0//EN&quot;</span>&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;title&gt;<span class="number">400</span> No required SSL certificate was sent&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;center&gt;&lt;h1&gt;<span class="number">400</span> Bad Request&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">&lt;center&gt;No required SSL certificate was sent&lt;/center&gt;</span><br><span class="line"> Sorry <span class="keyword">for</span> the inconvenience.&lt;br/&gt;</span><br><span class="line">Please report this message and include the following information to us.&lt;br/&gt;</span><br><span class="line">Thank you very much!&lt;/p&gt;</span><br><span class="line">&lt;table&gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">&lt;td&gt;URL:&lt;/td&gt;</span><br><span class="line">&lt;td&gt;https://integration<span class="literal">-fred2</span>.fredhuang.com:<span class="number">444</span>/&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">&lt;td&gt;Server:&lt;/td&gt;</span><br><span class="line">&lt;td&gt;cag<span class="literal">-access</span><span class="literal">-tengine011192099198</span>.au49&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">&lt;td&gt;Date:&lt;/td&gt;</span><br><span class="line">&lt;td&gt;<span class="number">2019</span>/<span class="number">11</span>/<span class="number">01</span> <span class="number">19</span>:<span class="number">25</span>:<span class="number">28</span>&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;hr/&gt;Powered by Tengine&lt;hr&gt;&lt;center&gt;tengine&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="5-Java-è°ƒç”¨"><a href="#5-Java-è°ƒç”¨" class="headerlink" title="5.Java è°ƒç”¨"></a>5.Java è°ƒç”¨</h2><p>ç”±äºä½¿ç”¨çš„æ˜¯è‡ªç­¾åè¯ä¹¦ï¼Œä½¿ç”¨ <code>ApacheHttpClient</code> å»è°ƒç”¨çš„è¯ï¼Œéœ€è¦å°†æœåŠ¡å™¨è¯ä¹¦åŠ å…¥å¯ä¿¡ä»»è¯ä¹¦åº“ä¸­ï¼Œæ‰èƒ½æˆåŠŸè°ƒç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨ä»£ç ä¸­ç®€å•å¿½ç•¥è¯ä¹¦ã€‚</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$</span> <span class="built_in">cd</span> <span class="variable">$JAVA_HOME</span></span><br><span class="line"><span class="variable">$</span> sudo ./bin/keytool <span class="literal">-import</span> <span class="literal">-alias</span> ttt <span class="literal">-keystore</span> cacerts <span class="operator">-file</span> /Users/fred/temp/cert5/server.crt</span><br></pre></td></tr></table></figure>

<p>å°†æœåŠ¡å™¨ç«¯å…¬é’¥è¯ä¹¦è®¾ç½®ä¸ºå¯ä¿¡è¯ä¹¦åï¼Œä½¿ç”¨ä»¥ä¸‹ä»£ç å¯ä»¥ç›´æ¥å‘èµ·å¸¦å®¢æˆ·ç«¯è¯ä¹¦çš„ <code>HTTPS</code> è¯·æ±‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.http.HttpEntity;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.methods.CloseableHttpResponse;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.client.methods.HttpGet;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.conn.ssl.SSLConnectionSocketFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.impl.client.CloseableHttpClient;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.impl.client.HttpClients;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.ssl.SSLContexts;</span><br><span class="line"><span class="keyword">import</span> org.apache.http.util.EntityUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.SSLContext;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyStore;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpClientWithClientCert</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> String PFX_PATH = <span class="string">&quot;/Users/fred/temp/cert5/client.p12&quot;</span>;    <span class="comment">//å®¢æˆ·ç«¯è¯ä¹¦è·¯å¾„</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> String PFX_PWD = <span class="string">&quot;123456&quot;</span>;    <span class="comment">//å®¢æˆ·ç«¯è¯ä¹¦å¯†ç </span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">sslRequestGet</span><span class="params">(String url)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        KeyStore keyStore = KeyStore.getInstance(<span class="string">&quot;PKCS12&quot;</span>);</span><br><span class="line">        InputStream instream = <span class="keyword">new</span> FileInputStream(<span class="keyword">new</span> File(PFX_PATH));</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            keyStore.load(instream, PFX_PWD.toCharArray());</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            instream.close();</span><br><span class="line">        &#125;</span><br><span class="line">        SSLContext sslcontext = SSLContexts.custom().loadKeyMaterial(keyStore, PFX_PWD.toCharArray()).build();</span><br><span class="line">        SSLConnectionSocketFactory sslsf = <span class="keyword">new</span> SSLConnectionSocketFactory(sslcontext</span><br><span class="line">                , <span class="keyword">new</span> String[] &#123; <span class="string">&quot;TLSv1&quot;</span> &#125;    <span class="comment">// supportedProtocols ,è¿™é‡Œå¯ä»¥æŒ‰éœ€è¦è®¾ç½®</span></span><br><span class="line">                , <span class="keyword">null</span>    <span class="comment">// supportedCipherSuites</span></span><br><span class="line">                , SSLConnectionSocketFactory.getDefaultHostnameVerifier());</span><br><span class="line"></span><br><span class="line">        CloseableHttpClient httpclient = HttpClients.custom().setSSLSocketFactory(sslsf).build();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            HttpGet httpget = <span class="keyword">new</span> HttpGet(url);</span><br><span class="line">            <span class="comment">//httpget.addHeader(&quot;host&quot;, &quot;integration-fred2.fredhuang.com&quot;);// è®¾ç½®ä¸€äº›heanderç­‰</span></span><br><span class="line">            CloseableHttpResponse response = httpclient.execute(httpget);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                HttpEntity entity = response.getEntity();</span><br><span class="line">                String jsonStr = EntityUtils.toString(response.getEntity(), <span class="string">&quot;UTF-8&quot;</span>);<span class="comment">//è¿”å›ç»“æœ</span></span><br><span class="line">                EntityUtils.consume(entity);</span><br><span class="line">                <span class="keyword">return</span> jsonStr;</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                response.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            httpclient.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(System.getProperty(<span class="string">&quot;java.home&quot;</span>));</span><br><span class="line">        System.out.println(sslRequestGet(<span class="string">&quot;https://integration-fred2.fredhuang.com/test&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-å­˜ç–‘"><a href="#6-å­˜ç–‘" class="headerlink" title="6. å­˜ç–‘"></a>6. å­˜ç–‘</h2><p>ç½‘ä¸Šå¾ˆå¤šæ–‡ç« éƒ½æè¿°åˆ° <code>Nginx</code> é…ç½®ä¸­çš„å®¢æˆ·ç«¯è¯ä¹¦ï¼ˆ<code>ssl_client_certificate</code>ï¼‰å¯ä»¥é…ç½®æ ¹è¯ä¹¦ root.crtï¼Œç„¶åå°±å¯ä»¥é€‚é…æ‰€æœ‰è¿™ä¸ªæ ¹è¯ä¹¦åŠæ³•çš„å®¢æˆ·ç«¯å…¬é’¥è¯ä¹¦äº†ã€‚æˆ‘è¯•äº†ï¼Œä½¿ç”¨ root.crt ä½œä¸º <code>ssl_client_certificate</code> çš„å€¼ï¼Œç„¶åä½¿ç”¨ client.crt æ¥è®¿é—®ï¼Œå‘ç°ä¸è¡Œï¼Œ<code>Nginx</code> ä¼šæŠ¥è¿™ä¸ªé”™è¯¯ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">title</span>&gt;</span>400 The SSL certificate error<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span>400 Bad Request<span class="tag">&lt;/<span class="name">h1</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span>The SSL certificate error<span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span><span class="tag">&lt;<span class="name">center</span>&gt;</span>nginx/1.17.5<span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªç‰¹æ€§åŸä½œè€…ä¸€ç›´æ²¡æœ‰é…ç½®æˆåŠŸ (æˆ‘ä¹Ÿæ²¡é…ç½®æˆåŠŸ)ï¼Œæœ‰å¯èƒ½æ˜¯é…ç½®æœ‰é—®é¢˜ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ç½‘ä¸Šæ–‡ç« ä¸é è°±ï¼Œå†™é”™äº†ã€‚</p>
<blockquote>
<p>æœ¬æ–‡è½¬è½½è‡ªï¼šã€Œé˜¿é‡Œäº‘å¼€å‘è€…ç¤¾åŒºã€ï¼ŒåŸæ–‡ï¼š<a target="_blank" rel="noopener" href="https://tinyurl.com/yaamh7vf">https://tinyurl.com/yaamh7vf</a> ï¼Œç‰ˆæƒå½’åŸä½œè€…æ‰€æœ‰ã€‚æ¬¢è¿æŠ•ç¨¿ï¼ŒæŠ•ç¨¿é‚®ç®±: <a href="mailto:editor@hi-linux.com">editor@hi-linux.com</a>ã€‚</p>
</blockquote>
<h2 id="7-æ‰©å±•é˜…è¯»-æœ¬æ–‡æ ¸å¿ƒ"><a href="#7-æ‰©å±•é˜…è¯»-æœ¬æ–‡æ ¸å¿ƒ" class="headerlink" title="7. æ‰©å±•é˜…è¯» (æœ¬æ–‡æ ¸å¿ƒ)"></a>7. æ‰©å±•é˜…è¯» (æœ¬æ–‡æ ¸å¿ƒ)</h2><p>åœ¨åŸæ–‡åŸºç¡€ä¸Šï¼Œæˆ‘åœ¨åˆ†äº«ä¸€ä¸ªä½ åœ¨å¤§å¤šæ•°ç½‘ç«™å’Œæœç´¢å¼•æ“ä¸­éƒ½æ‰¾ä¸åˆ°çš„å¾ˆå®ç”¨çš„å°æŠ€å·§ï¼Œè¯´å¾—è¿™ä¹ˆç¥ç§˜åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<br>é‚£å°±æ˜¯ä½¿ç”¨å—ä¿¡è¯ä¹¦è¿›è¡ŒåŒå‘è®¤è¯ï¼Œç½‘ä¸Šå¤§å¤šæ•°æ–‡ç« ä»‹ç»çš„å®ç° <code>HTTPS</code> åŒå‘è®¤è¯çš„æ–‡ç« éƒ½æ˜¯ä½¿ç”¨ <code>CA</code> è‡ªç­¾çš„æ–¹å¼è¿›è¡Œã€‚è™½ç„¶è¿™èƒ½å®ç°ç›®çš„ï¼Œä½†æ–¹æ³•ä¸å¤ªä¼˜é›…ã€‚<br>åœ¨ <code>SSL</code> è¯ä¹¦å…¨é¢æ™®åŠçš„å½“ä¸‹ï¼Œä½ å…¶å®å¾ˆæœ‰å¿…è¦ç”³è¯·ä¸€ä¸ªå—ä¿¡è¯ä¹¦æ¥è¿›è¡Œ <code>HTTPS</code> åŒå‘è®¤è¯ã€‚è¿™æ ·çœ‹ä¸Šå»ä¸ä½†æ›´æƒå¨ï¼Œè€Œä¸”å®ç°ä¸Šä¹Ÿæ›´ä¾¿æ·ä¸€äº›ã€‚</p>
<h3 id="ä½¿ç”¨å—ä¿¡è¯ä¹¦è¿›è¡ŒåŒå‘è®¤è¯"><a href="#ä½¿ç”¨å—ä¿¡è¯ä¹¦è¿›è¡ŒåŒå‘è®¤è¯" class="headerlink" title="ä½¿ç”¨å—ä¿¡è¯ä¹¦è¿›è¡ŒåŒå‘è®¤è¯"></a>ä½¿ç”¨å—ä¿¡è¯ä¹¦è¿›è¡ŒåŒå‘è®¤è¯</h3><p>è¦ä½¿ç”¨å—ä¿¡è¯ä¹¦è¿›è¡Œè®¤è¯çš„å‰ææ¡ä»¶ï¼šå½“ç„¶æ˜¯ä½ å¿…é¡»æœ‰ä¸€ä¸ªæƒå¨ CA æœºæ„ç»™ä½ ç­¾å‘çš„è¯ä¹¦ã€‚</p>
<ul>
<li>å¦‚æœä½ æ˜¯åœŸè±ªï¼Œéšä¾¿è´­ä¹°ä¸€ä¸ªå°±è¡Œäº†ã€‚</li>
<li>å¦‚æœä½ å›Šä¸­ç¾æ¶©ï¼Œä¹Ÿä¸è¦ç´§ï¼Œå¯ä»¥å»ç”³è¯·ä¸€ä¸ªå…è´¹çš„ <code>SSL</code> è¯ä¹¦ã€‚ç›®å‰ <code>Let&#39;s Encrypt</code>ã€<code>é˜¿é‡Œäº‘</code> éƒ½å¯ä»¥ç”³è¯·ï¼Œå…·ä½“æ–¹æ³•å°±ä¸åœ¨è¿™å±•å¼€äº†ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨å…¬ä¼—å·ä¸Šæœç´¢ç›¸å…³æ–‡ç« ã€‚</li>
<li>ä¸ºäº†ä¾¿äºç®¡ç†å’Œå¤šåœºæ™¯ä½¿ç”¨ï¼Œå»ºè®®ç›´æ¥ç”³è¯·é€šé…è¯ä¹¦ã€‚</li>
</ul>
<p>è¯ä¹¦å‡†å¤‡å®Œæˆåï¼Œæ¥ä¸‹æ¥å½“ç„¶æ˜¯ç›´æ¥ä½¿ç”¨å®ƒã€‚å› ä¸ºæ˜¯å—ä¿¡è¯ä¹¦ï¼Œä¸Šé¢æ‰€æœ‰çš„è¯ä¹¦è‡ªç­¾æ“ä½œéƒ½ä¸éœ€è¦äº†ï¼Œä½ åªéœ€ç›´æ¥é…ç½® <code>Nginx</code> å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">443</span> ssl;</span><br><span class="line">    <span class="attribute">access_log</span>  /var/log/nginx/accesse.log  main;</span><br><span class="line">    <span class="attribute">server_name</span>  ci.hi-linux.com;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="attribute">ssl_certificate</span>      /etc/ssl/certs/hi-linux.com/hi-linux.com.pem;</span><br><span class="line">    <span class="attribute">ssl_certificate_key</span>  /etc/ssl/certs/hi-linux.com/hi-linux.com.key;</span><br><span class="line">    <span class="attribute">ssl_client_certificate</span> /etc/ssl/certs/hi-linux.com/hi-linux.com.pem;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">ssl_verify_depth</span> <span class="number">3</span>;</span><br><span class="line">    <span class="attribute">ssl_session_timeout</span>  <span class="number">5m</span>;</span><br><span class="line">    <span class="attribute">ssl_verify_client</span> <span class="literal">on</span>;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">ssl_protocols</span>  SSLv2 SSLv3 TLSv1;</span><br><span class="line">    <span class="attribute">ssl_ciphers</span> ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP;</span><br><span class="line">    <span class="attribute">ssl_prefer_server_ciphers</span>   <span class="literal">on</span>;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">            <span class="attribute">proxy_pass</span>   http://ci/;</span><br><span class="line">            <span class="attribute">proxy_set_header</span> Host $host:$server_port;</span><br><span class="line">            <span class="attribute">proxy_set_header</span> X-Real-IP $remote_addr;</span><br><span class="line">            <span class="attribute">proxy_set_header</span> X-Forwarded-Proto $scheme;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼š<code>ssl_certificate</code> æŒ‡å®šçš„æ˜¯è¯ä¹¦ï¼Œ<code>ssl_certificate_key</code> æŒ‡å®šæ˜¯è¯ä¹¦å¯¹åº”çš„ç§é’¥ï¼Œè¯·è‡ªè¡Œå°†å¯¹åº”è¯ä¹¦æ–‡ä»¶æ”¾åˆ°é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šçš„ç›®å½•ä¸­ã€‚<br>ä»¥ä¸Šé…ç½®æ®µå’Œä¸Šé¢çš„è‡ªç­¾è¯ä¹¦å¤§åŒå°å¼‚ï¼Œä¸»è¦éœ€æ³¨æ„çš„æœ‰ <code>ssl_client_certificate</code> å’Œ <code>ssl_verify_depth</code> è¿™ä¸¤ä¸ªå‚æ•°ã€‚</p>
<ul>
<li><code>ssl_client_certificate</code> ä¸»è¦ç”¨äºæŒ‡å®šå®¢æˆ·ç«¯æ‰€ä½¿ç”¨çš„è¯ä¹¦ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥ä½¿ç”¨å—ä¿¡è¯ä¹¦æœºæ„ç­¾å‘çš„è¯ä¹¦æ–‡ä»¶ã€‚</li>
<li><code>ssl_verify_depth</code> è¿™ä¸ªå‚æ•°æ˜¯ä½¿ç”¨å—ä¿¡è¯ä¹¦èƒ½æˆåŠŸè¿›è¡Œå®¢æˆ·ç«¯éªŒè¯çš„å…³é”®ï¼Œæ³¨æ„å®ƒçš„å€¼æ˜¯ <code>3</code>ã€‚</li>
</ul>
<p>å› ä¸ºå½“ <code>ssl_verify_depth</code> è®¾ç½®ä¸º <code>1</code>ï¼ˆ <code>Nginx</code> çš„é»˜è®¤å€¼ï¼‰çš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯åªä¼šæ¥å—ç›´æ¥è¢« <code>CA</code> ç­¾å‘çš„å®¢æˆ·ç«¯è¯ä¹¦æˆ–è‡ªç­¾åçš„è¯ä¹¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç›´æ¥å°è¯•ä½¿ç”¨ä¸­çº§ <code>CA</code> æ¥éªŒè¯å®¢æˆ·ç«¯æ˜¯æ— æ³•é€šè¿‡çš„ï¼Œ<code>OpenSSL</code> ä¼šè‡ªåŠ¨çš„å»æ‰¾ä¸­çº§ <code>CA</code> çš„ç­¾å‘è€…å¹¶ä¸€å±‚å±‚éªŒè¯ä¸Šå»ï¼Œç›´åˆ°æ‰¾åˆ°æ ¹è¯ä¹¦ã€‚<br>æ‰€ä»¥ï¼Œå°±ç®—å°†ä¸­çº§ <code>CA</code> å’Œæ ¹ <code>CA</code> éƒ½æ”¾åœ¨ä¿¡ä»»è¯ä¹¦åˆ—è¡¨ä¸­ï¼Œç”±äºæœ€ç»ˆ <code>ssl_verify_depth</code> ä¸º <code>2</code> çš„ç¼˜æ•…ï¼ŒéªŒè¯è¿˜æ˜¯é€šä¸è¿‡çš„ã€‚<br>å› æ­¤ï¼Œåœ¨å®é™…ä½¿ç”¨çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p>
<ul>
<li>CA æ–‡ä»¶ä¸­å¿…é¡»åŒæ—¶å­˜åœ¨ ä¸­çº§ <code>CA</code> å’Œæ ¹ <code>CA</code>ï¼Œå¿…é¡»æ„æˆå®Œæ•´è¯ä¹¦é“¾ï¼Œä¸èƒ½å°‘ä»»ä½•ä¸€ä¸ªï¼›</li>
<li>é»˜è®¤çš„éªŒè¯æ·±åº¦ <code>ssl_verify_depth</code> æ˜¯ 1ï¼Œä¸­çº§ <code>CA</code> ç­¾å‘çš„å®¢æˆ·ç«¯è¯ä¹¦ä¸€å¾‹æ— æ³•é€šè¿‡è®¤è¯ï¼Œéœ€è¦å¢å¤§è¯¥å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸Šé¢é…ç½®ä¸­ <code>ssl_verify_depth</code> å€¼ä¸º <code>3</code> ã€‚</li>
</ul>
<p>ä¸ºäº†å®¢æˆ·ç«¯æ–¹ä¾¿å¯¼å…¥ï¼Œä½ åŒæ ·è¿˜æ˜¯éœ€è¦å°†è¯ä¹¦æ–‡ä»¶è½¬æ¢æˆ P12 æ ¼å¼ã€‚å½“ç„¶ä½ è¿˜å¯ä»¥åœ¨è½¬æ¢çš„è¿‡ç¨‹ä¸­ç»™è¯ä¹¦åŠ ä¸ªå¯†ç ï¼Œä»¥ä¿è¯è¯ä¹¦çš„å®‰å…¨ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ openssl pkcs12 -export -clcerts -in hi-linux.com.pem -inkey hi-linux.com.key -out hi-linux.com-client.p12</span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤ï¼Œ<code>HTTPS</code> åŒå‘è¯ä¹¦çš„å®ç°å°±è®²å®Œäº†ï¼Œå¦‚æœä½ è¿˜æœ‰ä»€ä¹ˆæ›´å¥½çš„è¡¥å……ï¼Œæ¬¢è¿å¤§å®¶ç§¯æç•™è¨€äº¤æµå“Ÿï¼</p>

  </div>
</article>


    
<div class="gitalk" id="gitalk-container"></div>
<link rel="stylesheet" href="/gDark.css" media="screen" type="text/css"> 
//
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>


<script src="/gitalk.min.js"></script>


<script src="/md5.min.js"></script>

<script type="text/javascript">
  var gitalk = new Gitalk({
    clientID: 'c0fd3fecc668416852dc',
    clientSecret: '5f849bbb22f9233b3fe19627c9eb28be39b721d1',
    repo: 'YYBlogGiTalk',
    owner: 'ATommyGirl',
    admin: ['ATommyGirl'],
    // id: location.pathname,      // Ensure uniqueness and length less than 50
    id: md5(location.pathname),
    distractionFreeMode: false,  // Facebook-like distraction free mode
    pagerDirection: 'last',
    proxy: 'https://tommygirl.cn/gitalk/access_token'
  })

  gitalk.render('gitalk-container')
</script>


    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>åŠ è½½è¯„è®ºéœ€è¦åœ¨æµè§ˆå™¨å¯ç”¨ JavaScript è„šæœ¬æ”¯æŒã€‚</noscript>
        </div>
    </div>
    



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives">å½’æ¡£</a></li>
         
          <li><a href="/tags">æ ‡ç­¾</a></li>
         
          <li><a href="/about">å…³äº</a></li>
         
          <li><a href="/search/">æœç´¢</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%8E%9F%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">1. åŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%8D%95%E5%90%91%E8%AE%A4%E8%AF%81%E6%B5%81%E7%A8%8B"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 å•å‘è®¤è¯æµç¨‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81%E6%B5%81%E7%A8%8B"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 åŒå‘è®¤è¯æµç¨‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%AF%81%E4%B9%A6%E7%94%9F%E6%88%90"><span class="toc-number">2.</span> <span class="toc-text">2. è¯ä¹¦ç”Ÿæˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E7%94%9F%E6%88%90%E8%87%AA%E7%AD%BE%E5%90%8D%E6%A0%B9%E8%AF%81%E4%B9%A6"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 ç”Ÿæˆè‡ªç­¾åæ ¹è¯ä¹¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E7%94%9F%E6%88%90%E8%87%AA%E7%AD%BE%E5%90%8D%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%81%E4%B9%A6"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 ç”Ÿæˆè‡ªç­¾åæœåŠ¡å™¨ç«¯è¯ä¹¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E7%94%9F%E6%88%90%E8%87%AA%E7%AD%BE%E5%90%8D%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%AF%81%E4%B9%A6"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 ç”Ÿæˆè‡ªç­¾åå®¢æˆ·ç«¯è¯ä¹¦</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Nginx-%E9%85%8D%E7%BD%AE"><span class="toc-number">3.</span> <span class="toc-text">3.Nginx é…ç½®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-curl-%E8%B0%83%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">4.curl è°ƒç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Java-%E8%B0%83%E7%94%A8"><span class="toc-number">5.</span> <span class="toc-text">5.Java è°ƒç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%AD%98%E7%96%91"><span class="toc-number">6.</span> <span class="toc-text">6. å­˜ç–‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E6%89%A9%E5%B1%95%E9%98%85%E8%AF%BB-%E6%9C%AC%E6%96%87%E6%A0%B8%E5%BF%83"><span class="toc-number">7.</span> <span class="toc-text">7. æ‰©å±•é˜…è¯» (æœ¬æ–‡æ ¸å¿ƒ)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%8F%97%E4%BF%A1%E8%AF%81%E4%B9%A6%E8%BF%9B%E8%A1%8C%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81"><span class="toc-number">7.1.</span> <span class="toc-text">ä½¿ç”¨å—ä¿¡è¯ä¹¦è¿›è¡ŒåŒå‘è®¤è¯</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&text=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&title=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&is_video=false&description=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯&body=Check out this article: https://tommygirl.cn/2021/08/11/Nginx_HTTPS/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&title=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&title=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&title=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&title=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&name=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯&description=&lt;p&gt;ä»¥ä¸‹å†…å®¹è½¬è½½è‡ª &lt;a href=&#34;https://www.hi-linux.com/posts/38492.html&#34;&gt;è¿™é‡Œ&lt;/a&gt; ã€‚è½¬è½½çš„åŸå› æ˜¯æ€•ä»–ä»¬çš„ç½‘ç«™çªç„¶è®¿é—®ä¸äº†ğŸ˜‚ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;ç ”ç©¶ HTTPS çš„åŒå‘è®¤è¯å®ç°ä¸åŸç†ï¼Œè¸©äº†ä¸å°‘å‘ï¼Œç»ˆäºæ•´ä¸ªæµç¨‹éƒ½è·‘é€šäº†ï¼Œç°åœ¨æ€»ç»“å‡ºä¸€ç¯‡æ–‡æ¡£æ¥ï¼ŒæŠŠä¸€äº›å¿ƒå¾—ï¼Œç‰¹åˆ«æ˜¯å®¹æ˜“è¸©å‘çš„åœ°æ–¹è®°å½•ä¸‹æ¥ã€‚&lt;/p&gt;
&lt;h2 id=&#34;1-åŸç†&#34;&gt;&lt;a href=&#34;#1-åŸç†&#34; class=&#34;headerlink&#34; title=&#34;1. åŸç†&#34;&gt;&lt;/a&gt;1. åŸç†&lt;/h2&gt;&lt;p&gt;åŒå‘è®¤è¯ï¼Œé¡¾åæ€ä¹‰ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½éœ€è¦éªŒè¯å¯¹æ–¹çš„èº«ä»½ï¼Œåœ¨å»ºç«‹ &lt;code&gt;HTTPS&lt;/code&gt; è¿æ¥çš„è¿‡ç¨‹ä¸­ï¼Œæ¡æ‰‹çš„æµç¨‹æ¯”å•å‘è®¤è¯å¤šäº†å‡ æ­¥ã€‚å•å‘è®¤è¯çš„è¿‡ç¨‹ï¼Œå®¢æˆ·ç«¯ä»æœåŠ¡å™¨ç«¯ä¸‹è½½æœåŠ¡å™¨ç«¯å…¬é’¥è¯ä¹¦è¿›è¡ŒéªŒè¯ï¼Œç„¶åå»ºç«‹å®‰å…¨é€šä¿¡é€šé“ã€‚åŒå‘é€šä¿¡æµç¨‹ï¼Œå®¢æˆ·ç«¯é™¤äº†éœ€è¦ä»æœåŠ¡å™¨ç«¯ä¸‹è½½æœåŠ¡å™¨çš„å…¬é’¥è¯ä¹¦è¿›è¡ŒéªŒè¯å¤–ï¼Œè¿˜éœ€è¦æŠŠå®¢æˆ·ç«¯çš„å…¬é’¥è¯ä¹¦ä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯ç»™æœåŠ¡å™¨ç«¯è¿›è¡ŒéªŒè¯ï¼Œç­‰åŒæ–¹éƒ½è®¤è¯é€šè¿‡äº†ï¼Œæ‰å¼€å§‹å»ºç«‹å®‰å…¨é€šä¿¡é€šé“è¿›è¡Œæ•°æ®ä¼ è¾“ã€‚&lt;/p&gt;
&lt;h3 id=&#34;1-1-å•å‘è®¤è¯æµç¨‹&#34;&gt;&lt;a href=&#34;#1-1-å•å‘è®¤è¯æµç¨‹&#34; class=&#34;headerlink&#34; title=&#34;1.1 å•å‘è®¤è¯æµç¨‹&#34;&gt;&lt;/a&gt;1.1 å•å‘è®¤è¯æµç¨‹&lt;/h3&gt;&lt;p&gt;å•å‘è®¤è¯æµç¨‹ä¸­ï¼ŒæœåŠ¡å™¨ç«¯ä¿å­˜ç€å…¬é’¥è¯ä¹¦å’Œç§é’¥ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ•´ä¸ªæ¡æ‰‹è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://tommygirl.cn/2021/08/11/Nginx_HTTPS/&t=ã€è½¬è½½ã€‘å·§ç”¨ Nginx å¿«é€Ÿå®ç° HTTPS åŒå‘è®¤è¯"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> èœå•</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> ç›®å½•</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> åˆ†äº«</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> è¿”å›é¡¶éƒ¨</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives">å½’æ¡£</a></li>
         
          <li><a href="/tags">æ ‡ç­¾</a></li>
         
          <li><a href="/about">å…³äº</a></li>
         
          <li><a href="/search/">æœç´¢</a></li>
        
      </ul>
    </nav> 
  </div>
  <div class="footer-right">
      YYLittleCat
      Copyright &copy;
      
      
      2015-2023
  </div>
  <a target="_blank" rel="noopener" href="https://beian.miit.gov.cn">æ´¥ICPå¤‡2021005176å·</a>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"å¤åˆ¶åˆ°ç²˜è´´æ¿!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "å¤åˆ¶æˆåŠŸ!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"left","width":300,"height":600,"vOffset":-100,"hOffset":50},"mobile":{"show":false},"log":false});</script></body>
</html>
